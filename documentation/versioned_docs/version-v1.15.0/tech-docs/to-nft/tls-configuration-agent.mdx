---
id: tls-configuration-agent
---

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

# Установка

<div>
  Настройка TLS (Transport Layer Security) на hbf-агенте обеспечивает шифрование трафика между сервером и клиентом,
  что повышает безопасность передаваемых данных. В этой документации описан процесс настройки TLS на hbf-агенте, включая
  использование предоставленного конфигурационного файла.
</div>

<div>
  Прежде чем приступить к настройке TLS, убедитесь, что у вас есть:
  <ul>
    <li>Установленный hbf-агент</li>
    <li>Включен и настроен TLS на hbf-сервере</li>
    <li>Сертификат SSL и соответствующий приватный ключ. Если у вас их нет, вы можете получить их у сертификационного
    центра (CA) или создать самоподписанный сертификат для тестовых целей.</li>
  </ul>
</div>

## Шаги по настройке TLS

<div>
  Создайте файл конфигурации hbf-агента для редактирования:

```bash
sudo nano /etc/cmd/sgroups/tls-config.yaml
```
  Далее необходимо настроить секцию для TLS:
</div>

<Tabs
    defaltValue = "itls"
    values = {[
        { label: "Insecure TLS", value: "itls" },
        { label: "Secure TLS", value: "tls" },
        { label: "mTLS", value: "mtls" },
    ]}
>

    <TabItem value="itls">
      ```bash
      extapi:
        svc:
          authn:
            type: tls
            tls:
              server:
                verify: false
      ```
      <p>`type` - Допустимые значени: `none` или `tls`. При значении `none` tls отключен, при значении `tls` tls включен.</p>

      <p>`tls.key-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/private/key-file.pem`  или относительный путь `./../key-file.pem` с названием файла ключа.</p>

      <p>`tls.cert-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/certs/cert-file.pem`  или относительный путь `./../cert-file.pem` с названием файла сертификата.</p>

      <p>`verify` - Допустимые значени: `true` или `false`. При значении `true` включен режим проверки сертификата сервера, при значении `false` данный режим отключен.</p>
    </TabItem>

    <TabItem value="tls">
      ```bash
      extapi:
        svc:
          authn:
            type: tls
            tls:
              server:
                verify: true
                name: "server-name"
                ca-files: ["file1.pem", "file2.pem", ...]
      ```
      <p>`type` - Допустимые значени: `none` или `tls`. При значении `none` tls отключен, при значении `tls` tls включен.</p>

      <p>`tls.key-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/private/key-file.pem`  или относительный путь `./../key-file.pem` с названием файла ключа.</p>

      <p>`tls.cert-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/certs/cert-file.pem`  или относительный путь `./../cert-file.pem` с названием файла сертификата.</p>

      <p>`verify` - Допустимые значени: `true` или `false`. При значении `true` включен режим проверки сертификата сервера, при значении `false` данный режим отключен.</p>

      <p>`name` - При включенном режиме проверки сертификата сервера `verify: true` можно указать имя сервера. Поле не обязательное для заполнения, в случае если имя сервера не будет указано то подлинность будет проверяться по данным сертификата.</p>

      <p>`ca-files` - При включенном режиме проверки сертификата сервера `verify: true` необходимо перечислить список certificates authorities с указанием относительного или полного пути к файлам.</p>
    </TabItem>

    <TabItem value="mtls">
      ```bash
      extapi:
        svc:
          authn:
            type: tls
            tls:
              key-file: "/etc/ssl/private/key-file.pem"
              cert-file: "/etc/ssl/certs/cert-file.pem"
              server:
                verify: true
                name: "server-name"
                ca-files: ["file1.pem", "file2.pem", ...]
      ```
      <p>`type` - Допустимые значени: `none` или `tls`. При значении `none` tls отключен, при значении `tls` tls включен.</p>

      <p>`key-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/private/key-file.pem`  или относительный путь `./../key-file.pem` с названием файла ключа.</p>

      <p>`cert-file` - В случае если на сервере стоит настройка `verify: cert-required/verify`, то в этом случае необходимо установить сертификаты со стороны клиента. Необходимо указать полный путь `/etc/ssl/certs/cert-file.pem`  или относительный путь `./../cert-file.pem` с названием файла сертификата.</p>

      <p>`verify` - Допустимые значени: `true` или `false`. При значении `true` включен режим проверки сертификата сервера, при значении `false` данный режим отключен.</p>

      <p>`name` - При включенном режиме проверки сертификата сервера `verify: true` можно указать имя сервера. Поле не обязательное для заполнения, в случае если имя сервера не будет указано то подлинность будет проверяться по данным сертификата.</p>

      <p>`ca-files` - При включенном режиме проверки сертификата сервера `verify: true` необходимо перечислить список certificates authorities с указанием относительного или полного пути к файлам.</p>

    </TabItem>
</Tabs>
