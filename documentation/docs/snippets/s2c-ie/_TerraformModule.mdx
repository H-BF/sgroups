import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

import { Restrictions } from '@site/src/components/commonBlocks/Restrictions'
import { DICTIONARY } from '@site/src/constants/dictionary.ts'
import { RESTRICTIONS } from '@site/src/constants/restrictions.tsx'

<div className="paragraph">
  <p>{DICTIONARY['v1.13.0'].terraformModule.full}</p>
</div>
<div className="paragraph">
  Далее везде в документе подразумевается что все места, содержащие переменную `$traffic`, могут принять одно из двух
  значений: `Ingress` `Egress`. Аналогчично для `$transport` подразумевается одно из четырех значений: `tcp`, `udp`,
  `icmpIPv4`, `icmpIPv6`
</div>

<ul>
    <li className="text-justify">`rules` - {DICTIONARY['v1.13.0'].rules.short}</li>
    <li className="text-justify">`rules.$traffic[]` - {DICTIONARY['v1.13.0'].traffic.short}</li>
    <li className="text-justify">`rules.$traffic[].cidrSet[]` - {DICTIONARY['v1.13.0'].cidrSet.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport` - {DICTIONARY['v1.13.0'].transport.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.action` - {DICTIONARY['v1.13.0'].action.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.priority` - {DICTIONARY['v1.13.0'].priority.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.logs` - {DICTIONARY['v1.13.0'].log.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.trace` - {DICTIONARY['v1.13.0'].trace.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.ports[].description` - {DICTIONARY['v1.13.0'].description.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.ports[].ports_to[]` - {DICTIONARY['v1.13.0'].dstPorts.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.ports[].ports_from[]` - {DICTIONARY['v1.13.0'].srcPorts.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.types[].description` - {DICTIONARY['v1.13.0'].description.short}</li>
    <li className="text-justify">`rules.$traffic[].access.$transport.types[].type[]` - {DICTIONARY['v1.13.0'].icmpTypes.short}</li>

</ul>

<div className="scrollable-x">
  <table>
    <caption>Области применения полей относительно используемого протокола</caption>
    <thead>
      <tr>
        <th rowSpan="2">название параметра</th>
        <th rowSpan="2">тип данных</th>
        <th rowSpan="2">значение по умолчанию</th>
        <th colSpan="3">transport*</th>
      </tr>
      <tr>
        <th>TCP</th>
        <th>UDP</th>
        <th>ICMP</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>rules</td>
        <td>Object[]</td>
        <td>[]</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[]</td>
        <td>Object[]</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].cidrSet[]</td>
        <td>String[]</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport</td>
        <td>Object</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.action</td>
        <td>
          <nobr>Enum("ACCEPT", "DROP")</nobr>
        </td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.priority</td>
        <td>String</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.log</td>
        <td>Boolean</td>
        <td>false</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.trace</td>
        <td>Boolean</td>
        <td>false</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[]</td>
        <td>Object[]</td>
        <td>{}</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].description</td>
        <td>String</td>
        <td>&quot;&quot;</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center"></td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].ports_to[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center"></td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].ports_from[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center"></td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[]</td>
        <td>Object[]</td>
        <td></td>
        <td className="green center"></td>
        <td className="green center"></td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[].description</td>
        <td>String</td>
        <td>&quot;&quot;</td>
        <td className="green center"></td>
        <td className="green center"></td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[].type[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center"></td>
        <td className="green center"></td>
        <td className="green center">✔</td>
      </tr>
    </tbody>
  </table>
</div>

<h4 className="custom-heading">Ограничения</h4>

<ul>
  <li>
    `name`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].name} />
  </li>
  <li>
    `rules.$traffic[].cidrSet`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].cidrSet} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.priority`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].priority} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.ports[].ports_to[]`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].dstPorts} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.ports[].ports_from[]`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].srcPorts} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.types[].type[]`:
    <Restrictions data={RESTRICTIONS['v1.13.0'].icmpType} />
  </li>
</ul>

<h4 className="custom-heading">Пример использования</h4>

<Tabs
  defaltValue="tcp"
  values={[
    { label: 'TCP', value: 'tcp' },
    { label: 'UDP', value: 'udp' },
    { label: 'ICMP4', value: 'icmp4' },
    { label: 'ICMP6', value: 'icmp6' },
  ]}
>
  <TabItem value="tcp">
    <div className="parent-div" style={{ minHeight: '420px' }}>
      <div className="child-block">
        <h4 className="center"><a href='https://github.com/H-BF/swarm-spec-template/blob/master/spec/sg-local-example.yaml#L173'>Ingress</a></h4>

        ```yaml
        name: sg-local-example
        rules:
          ingress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                tcp:
                  action: ACCEPT
                  priority: 300
                  logs: true
                  trace: true
                  ports:
                    - description: "example"
                      ports_from:
                        - 64231
                      ports_to:
                        - 443
                        - 80
          ```

      </div>
      <div className="child-block">
        <h4 className="center"><a href='https://github.com/H-BF/swarm-spec-template/blob/master/spec/sg-local-example.yaml#L89'>Egress</a></h4>

        ```yaml
        name: sg-local-example
        rules:
          egress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                tcp:
                  action: ACCEPT
                  priority: 300
                  logs: true
                  trace: true
                  ports:
                    - description: "example"
                      ports_from:
                        - 64231
                      ports_to:
                        - 443
                        - 80
          ```

      </div>
    </div>

  </TabItem>
  <TabItem value="udp">
    <div className="parent-div">
      <div className="child-block">
        <h4 className="center">Ingress</h4>

        ```yaml
        name: sg-local-example
        rules:
          ingress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                udp:
                  action: ACCEPT
                  priority: 300
                  logs: true
                  trace: true
                  ports:
                    - description: "example"
                      ports_from:
                        - 64231
                      ports_to:
                        - 443
                        - 80
          ```

      </div>
      <div className="child-block">
        <h4 className="center">Egress</h4>

        ```yaml
        name: sg-local-example
        rules:
          egress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                udp:
                  action: ACCEPT
                  priority: 300
                  logs: true
                  trace: true
                  ports:
                    - description: "example"
                      ports_from:
                        - 64231
                      ports_to:
                        - 443
                        - 80
          ```
      </div>
    </div>

  </TabItem>
  <TabItem value="icmp4">
    <div className="parent-div">
      <div className="child-block">
        <h4 className="center">Ingress</h4>

        ```yaml
        name: sg-local-example
        rules:
          ingress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                icmpIPv4:
                  action: ACCEPT
                  priority: 200
                  logs: true
                  trace: true
                  types:
                    - description: "example"
                      type:
                        - 0
                        - 8
          ```

      </div>
      <div className="child-block">
        <h4 className="center">Egress</h4>

        ```yaml
        name: sg-local-example
        rules:
          egress:
            - cidrSet:
                - "10.0.0.0/8"
              access:
                icmpIPv4:
                  action: ACCEPT
                  priority: 200
                  logs: true
                  trace: true
                  types:
                    - description: "example"
                      type:
                        - 0
                        - 8
          ```
      </div>
    </div>

  </TabItem>

  <TabItem value="icmp6">
    <div className="parent-div">
      <div className="child-block">
        <h4 className="center">Ingress</h4>

        ```yaml
        name: sg-local-example
        rules:
          ingress:
            - cidrSet:
                - "::ffff:a00:0/104"
              access:
                icmpIPv6:
                  action: ACCEPT
                  priority: 200
                  logs: true
                  trace: true
                  types:
                    - description: "example"
                      type:
                        - 0
                        - 8
          ```

      </div>
      <div className="child-block">
        <h4 className="center">Egress</h4>

        ```yaml
        name: sg-local-example
        rules:
          egress:
            - cidrSet:
                - "::ffff:a00:0/104"
              access:
                icmpIPv6:
                  action: ACCEPT
                  priority: 200
                  logs: true
                  trace: true
                  types:
                    - description: "example"
                      type:
                        - 0
                        - 8
          ```
      </div>
    </div>

  </TabItem>

</Tabs>
