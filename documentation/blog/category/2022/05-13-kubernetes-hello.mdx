---
title: Kubernetes the hard way
description: Приключение на 20 минут вошли и вышли или как создать кластер по этапно
slug: kubernetes-hello
authors:
  - name: Путилин Дмитрий
    title:  Архитектор
    url: https://github.com/fr-solution
    image_url: https://avatars.githubusercontent.com/u/107264732?s=400&u=9e62851aa556117c3997181cd93b4bcccf2c0cc9&v=4
    socials:
      x: Dobry_kot
      github: fr-solution

tags: [K8S]
image: https://i.imgur.com/mErPwqL.png
hide_table_of_contents: false
---

import { FancyboxDiagram }      from '@site/src/components/commonBlocks/FancyboxDiagram'
import TabItem                  from '@theme/TabItem'
import Tabs                     from '@theme/Tabs'

import K8sDownloads             from '@site/blog-draft/kubernetes-the-hard-way/snippets/downloads.mdx'
import K8sSystem                from '@site/blog-draft/kubernetes-the-hard-way/snippets/system.mdx'
import CertsSchema              from '@site/blog-draft/kubernetes-the-hard-way/snippets/certs/schema.mdx'

import SetCertsCA               from '@site/blog-draft/kubernetes-the-hard-way/snippets/setCertsCA.mdx'
import SetCerts                 from '@site/blog-draft/kubernetes-the-hard-way/snippets/setCerts.mdx'
import StaticPods               from '@site/blog-draft/kubernetes-the-hard-way/snippets/staticPods.mdx'
import StartCluster             from '@site/blog-draft/kubernetes-the-hard-way/snippets/startCluster.mdx'
import StatusCluster            from '@site/blog-draft/kubernetes-the-hard-way/snippets/statusCluster.mdx'

import ComponentsInfo           from '@site/blog-draft/kubernetes-the-hard-way/snippets/components/components.mdx'
import ComponentsSetings        from '@site/blog-draft/kubernetes-the-hard-way/snippets/components/componentsSetings.mdx'

import CodeBlock                from '@theme/CodeBlock';

import { CUSTOM_VALUE }         from '@site/blog-draft/kubernetes-the-hard-way/constants/customValue'
import { CERTIFICATES }         from '@site/blog-draft/kubernetes-the-hard-way/constants/certs'
import { PORTS }                from '@site/blog-draft/kubernetes-the-hard-way/constants/ports'

import Arch                     from '@site/blog-draft/kubernetes-the-hard-way/snippets/flowcharts/arch.mdx'
import TopologyInfra            from '@site/blog-draft/kubernetes-the-hard-way/snippets/flowcharts/topologyInfra.mdx'

import PreparingTheEnvironment  from '@site/blog-draft/kubernetes-the-hard-way/snippets/preparingTheEnvironment.mdx'
import StagesOfCreation         from '@site/blog-draft/kubernetes-the-hard-way/snippets/stagesOfCreation.mdx'

import AboutK8S                 from '@site/blog-draft/kubernetes-the-hard-way/snippets/aboutK8S.mdx'
import Introduction             from '@site/blog-draft/kubernetes-the-hard-way/snippets/introduction.mdx'

Привет, друзья! С вами снова Дмитрий Путилин, и я рад продолжить нашу серию статей о Kubernetes. В этой статье мы вместе пройдем весь путь ручной установки контрол-плейна Kubernetes и доведем его до состояния, идентичного тому, что вы получили бы с помощью `kubeadm init`.

![Описание изображения](https://habrastorage.org/r/w1560/getpro/habr/upload_files/58b/103/4eb/58b1034eb64ffed83f0199bdcbc4e866.png)

<!-- truncate -->

## Введение
<Introduction />

## Для чего нужен Kubernetes
<AboutK8S />

## Основные компоненты Kubernetes
<ComponentsInfo />

## Архитектура 
<Arch />

## Этапы создания кластера Kubernetes
<StagesOfCreation />

## Подготовка окружения
<PreparingTheEnvironment />

## Загрузка компонентов
<K8sDownloads />

## Настройка ядра ОС
<K8sSystem />

## Настройка компонентов
<ComponentsSetings />

## Настройка сертификатов
<CertsSchema />

#### Настройка CA
<SetCertsCA />

#### Настройка сертификатов Kubernetes
<SetCerts />

## Настройка Static Pods
<StaticPods />

## Запуск кластера
<StartCluster />

## Статус кластера
<StatusCluster />

## Базовая настройка Kubeadm
- Маркировка узла
- Установка `Taints`
- Загрузка `kubelet-conf` и `kubeadm-conf` в кластер
- Загрузка корневых сертификатов в кластер
- Настройка ролевой модели
- Создание bootstrap tokens для 2-х остальных мастеров и добавление в `cluster-info`


