import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'
import { Restrictions } from '@site/src/components/commonBlocks/Restrictions'
import { DICTIONARY } from '@site/src/constants/dictionary.ts'
import { RESTRICTIONS } from '@site/src/constants/restrictions.tsx'

<div className="paragraph">
  <p>{DICTIONARY.terraformModule.full}</p>
</div>
<div className="paragraph">
  Далее везде в документе подразумевается что все места, содержащие переменную `$traffic`, могут принять одно из двух
  значений: `Ingress` `Egress`. Аналогчично для `$transport` подразумевается одно из четырех значений: `tcp`, `udp`,
  `icmpIPv4`, `icmpIPv6`
</div>
<ul>
  <li className="text-justify">`rules` - {DICTIONARY.rules.short}</li>
  <li className="text-justify">`rules.$traffic[]` - {DICTIONARY.traffic.short}</li>
  <li className="text-justify">`rules.$traffic[].sgroupSet[]` - {DICTIONARY.sgroupSet.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport` - {DICTIONARY.transport.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.action` - {DICTIONARY.action.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.priority` - {DICTIONARY.priority.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.log` - {DICTIONARY.log.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.trace` - {DICTIONARY.trace.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.ports[].description` - {DICTIONARY.description.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.ports[].ports_to[]` - {DICTIONARY.dstPorts.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.ports[].ports_from[]` - {DICTIONARY.srcPorts.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.types[].description` - {DICTIONARY.description.short}</li>
  <li className="text-justify">`rules.$traffic[].access.$transport.types[].type[]` - {DICTIONARY.icmpTypes.short}</li>
</ul>

<div className="scrollable-x">
  <table>
    <caption>Области применения полей относительно используемого протокола</caption>
    <thead>
      <tr>
        <th rowSpan="2">название параметра</th>
        <th rowSpan="2">тип данных</th>
        <th rowSpan="2">значение по умолчанию</th>
        <th colSpan="3">transport*</th>
      </tr>
      <tr>
        <th>TCP</th>
        <th>UDP</th>
        <th>ICMP</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>rules</td>
        <td>Object[]</td>
        <td>[]</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[]</td>
        <td>Object[]</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].sgroupSet[]</td>
        <td>String[]</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport</td>
        <td>Object</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.action</td>
        <td>
          <nobr>Enum("ACCEPT", "DROP")</nobr>
        </td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.priority</td>
        <td>String</td>
        <td></td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.log</td>
        <td>Boolean</td>
        <td>false</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.trace</td>
        <td>Boolean</td>
        <td>false</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[]</td>
        <td>Object[]</td>
        <td>&quot;&quot;</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].description</td>
        <td>String</td>
        <td>&quot;&quot;</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].ports_to[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center"></td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.ports[].ports_from[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center"></td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[]</td>
        <td>Object[]</td>
        <td>&quot;&quot;</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[].description</td>
        <td>String</td>
        <td>&quot;&quot;</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
        <td className="green center">✔</td>
      </tr>
      <tr>
        <td>rules.$traffic[].access.$transport.types[].type[]</td>
        <td>Integer[]</td>
        <td>null</td>
        <td className="green center"></td>
        <td className="green center"></td>
        <td className="green center">✔</td>
      </tr>
    </tbody>
  </table>
</div>

<h4 className="custom-heading">Ограничения</h4>

<ul>
  <li>
    `name`:
    <Restrictions data={RESTRICTIONS.name} />
  </li>
  <li>
    `rules.$traffic[].sgroupSet`:
    <Restrictions data={RESTRICTIONS.sgroupSet} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.priority`:
    <Restrictions data={RESTRICTIONS.priority} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.ports[].ports_to[]`:
    <Restrictions data={RESTRICTIONS.dstPorts} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.ports[].ports_from[]`:
    <Restrictions data={RESTRICTIONS.srcPorts} />
  </li>
  <li>
    `rules.$traffic[].access.$transport.types[].type[]`:
    <Restrictions data={RESTRICTIONS.icmpType} />
  </li>
</ul>

<h4 className="custom-heading"> Пример использования </h4>

<Tabs
    defaltValue = "tcp"
    values = {[
        { label: "TCP", value: "tcp" },
        { label: "UDP", value: "udp" },
        { label: "ICMP4", value: "icmp4" },
        { label: "ICMP6", value: "icmp6" }
    ]}
>
    <TabItem value="tcp">
        <div className="parent-div" style={{ minHeight: "420px" }}>
            <div className="child-block">
                <h4 className="center"><a href='https://github.com/H-BF/swarm-spec-template/blob/master/spec/sg-local-example.yaml#L144'>Ingress</a></h4>

                ```yaml
                name: "sg-local-example"
                rules:
                  ingress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        tcp:
                          action: ACCEPT
                          priority: 0
                          logs:  true
                          trace: true
                          ports:
                            - description: "example"
                              ports_from:
                                - 64231
                              ports_to:
                                - 443
                                - 80
                ```
            </div>
            <div className="child-block">
                <h4 className="center"><a href='https://github.com/H-BF/swarm-spec-template/blob/master/spec/sg-local-example.yaml#L60'>Egress</a></h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  egress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        tcp:
                          action: ACCEPT
                          priority: 0
                          logs:  true
                          trace: true
                          ports:
                            - description: "example"
                              ports_from:
                                - 64231
                              ports_to:
                                - 443
                                - 80
                ```
            </div>
        </div>
    </TabItem>
    <TabItem value="udp">
        <div className="parent-div">
            <div className="child-block">
                <h4 className="center">Ingress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  ingress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        udp:
                          action: ACCEPT
                          priority: 0
                          logs:  true
                          trace: true
                          ports:
                            - description: "example"
                              ports_from:
                                - 64231
                              ports_to:
                                - 443
                                - 80
                ```
            </div>
            <div className="child-block">
                <h4 className="center">Egress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  egress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        udp:
                          action: ACCEPT
                          priority: 0
                          logs:  true
                          trace: true
                          ports:
                            - description: "example"
                              ports_from:
                                - 64231
                              ports_to:
                                - 443
                                - 80
                ```
            </div>
        </div>
    </TabItem>
    <TabItem value="icmp4">
        <div className="parent-div">
            <div className="child-block">
                <h4 className="center">Ingress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  ingress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        icmpIPv4:
                          action: ACCEPT
                          priority: -100
                          logs:  true
                          trace: true
                          types:
                            - description: "example"
                              type:
                                - 0
                                - 8
                ```
            </div>
            <div className="child-block">
                <h4 className="center">Egress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  egress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        icmpIPv4:
                          action: ACCEPT
                          priority: -100
                          logs:  true
                          trace: true
                          types:
                            - description: "example"
                              type:
                                - 0
                                - 8
                ```
            </div>
        </div>
    </TabItem>

    <TabItem value="icmp6">
        <div className="parent-div">
            <div className="child-block">
                <h4 className="center">Ingress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  ingress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        icmpIPv6:
                          action: ACCEPT
                          priority: -100
                          logs:  true
                          trace: true
                          types:
                            - description: "example"
                              type:
                                - 0
                                - 8
                ```
            </div>
            <div className="child-block">
                <h4 className="center">Egress</h4>


                ```yaml
                name: "sg-local-example"
                rules:
                  egress:
                    - sgroupSet:
                        - "sg-example"
                      access:
                        icmpIPv6:
                          action: ACCEPT
                          priority: -100
                          logs:  true
                          trace: true
                          types:
                            - description: "example"
                              type:
                                - 0
                                - 8
                ```
            </div>
        </div>
    </TabItem>
</Tabs>
